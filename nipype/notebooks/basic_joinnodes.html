
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JoinNode, synchronize and itersource &#8212; MRI analysis in Python using Nipype, Nilearn and more</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Debugging Nipype Workflows" href="basic_debug.html" />
    <link rel="prev" title="MapNode" href="basic_mapnodes.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/nipy_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MRI analysis in Python using Nipype, Nilearn and more</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   Welcome!
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../overview.html">
   Workshop overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../setup.html">
   Setup for the workshop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outline.html">
   Outline
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../prerequisites.html">
   Course prerequisites
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/intro_to_shell.html">
     Introduction to the (unix) command line: bash
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/intro_to_git_and_github.html">
     Introduction to git and github
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/intro_jupyter.html">
     Introduction to the jupyter ecosystem &amp; notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/intro_python.html">
     Introduction to Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/python_numpy.html">
     Introduction to NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/python_scipy.html">
     Introduction to SciPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/python_visualization.html">
     Introduction to Visualization in python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/intro_statistics.html">
     Introduction to Statistics in python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../prerequisites/python_scikit.html">
     Introduction to scikit-learn &amp; scikit-image
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../data/data.html">
   Basics in data handling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../data/image_manipulation_nibabel.html">
     Using Python for neuroimaging data - NiBabel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../data/image_manipulation_nilearn.html">
     Using Python for neuroimaging data - Nilearn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../nipype_overview.html">
   Nipype
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype_intro.html">
     Introduction to Nipype
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="introduction_showcase.html">
       Nipype Showcase
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="introduction_quickstart.html">
       Nipype Quickstart
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="introduction_quickstart_non-neuroimaging.html">
       Nipype Quickstart - non-imaging
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="../nipype_basics.html">
     Basic concepts
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="basic_interfaces.html">
       Interfaces
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_nodes.html">
       Nodes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_workflow.html">
       Workflows
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_graph_visualization.html">
       Graph Visualization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_data_input.html">
       Data Input
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_data_input_bids.html">
       Data input for BIDS datasets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_data_output.html">
       Data Output
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_plugins.html">
       Using Nipype Plugins
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_function_interface.html">
       Function Interface
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_iteration.html">
       Iterables
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_mapnodes.html">
       MapNode
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       JoinNode, synchronize and itersource
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_debug.html">
       Debugging Nipype Workflows
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="basic_execution_configuration.html">
       Execution Configuration Options
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype_examples.html">
     Example workflows
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="example_preprocessing.html">
       Example 1: Preprocessing Workflow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="example_1stlevel.html">
       Example 2: 1st-level Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="example_normalize.html">
       Example 3: Normalize data to MNI template
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="example_2ndlevel.html">
       Example 4: 2nd-level Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="handson_preprocessing.html">
       Hands-on 1: How to create a fMRI preprocessing workflow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="handson_analysis.html">
       Hands-on 2: How to create a fMRI analysis workflow
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype_advanced.html">
     Advanced concepts
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="advanced_create_interfaces.html">
       Create interfaces
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="advanced_interfaces_caching.html">
       Interface caching
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="advanced_nipypecli.html">
       Nipype Command Line Interface
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="advanced_aws.html">
       Using Nipype with Amazon Web Services (AWS)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="advanced_sphinx_ext.html">
       Sphinx extensions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="advanced_spmmcr.html">
       Using SPM with MATLAB Common Runtime (MCR)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="advanced_mipav.html">
       Using MIPAV, JIST, and CBS Tools
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype_resources.html">
     Resources
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="resources_installation.html">
       Download and install
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="resources_help.html">
       Where to find help
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../advanced.html">
   Advanced and specialized analyses
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../advanced/pybids.html">
     Introduction to
     <code class="docutils literal notranslate">
      <span class="pre">
       pybids
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../advanced/statistical_analyses_MRI.html">
     Nilearn GLM: statistical analyses of MRI in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../advanced/functional_connectivity.html">
     Functional connectivity and resting state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../advanced/machine_learning_preparation.html">
     Preparation Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../advanced/machine_learning_nilearn.html">
     MVPA and Searchlight with
     <code class="docutils literal notranslate">
      <span class="pre">
       nilearn
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../advanced/machine_learning_keras.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       TensorFlow
      </span>
     </code>
     /
     <code class="docutils literal notranslate">
      <span class="pre">
       Keras
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../advanced/Predicting_age_with_machine_learning.html">
     Machine learning to predict age from rs-fmri
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../break.html">
   Yoga and/or dance break
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../CoC.html">
   Code of Conduct
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/nipype/notebooks/basic_joinnodes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/PeerHerholz/workshop_weizmann"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/PeerHerholz/workshop_weizmann/issues/new?title=Issue%20on%20page%20%2Fnipype/notebooks/basic_joinnodes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/PeerHerholz/workshop_weizmann/edit/master/lecture/nipype/notebooks/basic_joinnodes.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/PeerHerholz/workshop_weizmann/master?urlpath=tree/lecture/nipype/notebooks/basic_joinnodes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-example">
   Simple example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#synchronize">
   <code class="docutils literal notranslate">
    <span class="pre">
     synchronize
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#itersource">
   <code class="docutils literal notranslate">
    <span class="pre">
     itersource
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#more-realistic-joinnode-example">
   More realistic
   <code class="docutils literal notranslate">
    <span class="pre">
     JoinNode
    </span>
   </code>
   example
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#extending-to-multiple-nodes">
   Extending to multiple nodes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-1">
     Exercise 1
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="joinnode-synchronize-and-itersource">
<h1>JoinNode, synchronize and itersource<a class="headerlink" href="#joinnode-synchronize-and-itersource" title="Permalink to this headline">¶</a></h1>
<p>JoinNode has the opposite effect of <a class="reference internal" href="basic_iteration.html"><span class="doc std std-doc">iterables</span></a>. Where <code class="docutils literal notranslate"><span class="pre">iterables</span></code> split up the execution workflow into many different branches, a <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code> merges them back into on node. A <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code> generalizes <code class="docutils literal notranslate"><span class="pre">MapNode</span></code> to operate in conjunction with an upstream <code class="docutils literal notranslate"><span class="pre">iterable</span></code> node to reassemble downstream results, e.g.:</p>
<img src="../static/images/joinnode.png"  width="240"><div class="section" id="simple-example">
<h2>Simple example<a class="headerlink" href="#simple-example" title="Permalink to this headline">¶</a></h2>
<p>Let’s consider the very simple example depicted at the top of this page:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nipype</span> <span class="kn">import</span> <span class="n">Node</span><span class="p">,</span> <span class="n">JoinNode</span><span class="p">,</span> <span class="n">Workflow</span>

<span class="c1"># Specify fake input node A</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">A</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>

<span class="c1"># Iterate over fake node B&#39;s input &#39;in_file?</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">B</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;in_file&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">file1</span><span class="p">,</span> <span class="n">file2</span><span class="p">])</span>

<span class="c1"># Pass results on to fake node C</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">C</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>

<span class="c1"># Join forked execution workflow in fake node D</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">JoinNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">D</span><span class="p">(),</span>
             <span class="n">joinsource</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
             <span class="n">joinfield</span><span class="o">=</span><span class="s2">&quot;in_files&quot;</span><span class="p">,</span>
             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>

<span class="c1"># Put everything into a workflow as usual</span>
<span class="n">workflow</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;workflow&quot;</span><span class="p">)</span>
<span class="n">workflow</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="s1">&#39;subject&#39;</span><span class="p">)]),</span>
                  <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_file&#39;</span><span class="p">)])</span>
                  <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)])</span>
                  <span class="p">])</span>
</pre></div>
</div>
<p>As you can see, setting up a <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code> is rather simple. The only difference to a normal <code class="docutils literal notranslate"><span class="pre">Node</span></code> is the <code class="docutils literal notranslate"><span class="pre">joinsource</span></code> and the <code class="docutils literal notranslate"><span class="pre">joinfield</span></code>. <code class="docutils literal notranslate"><span class="pre">joinsource</span></code> specifies from which node the information to join is coming and the <code class="docutils literal notranslate"><span class="pre">joinfield</span></code> specifies the input field of the <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code> where the information to join will be entering the node.</p>
<p>This example assumes that interface <code class="docutils literal notranslate"><span class="pre">A</span></code> has one output <em>subject</em>, interface <code class="docutils literal notranslate"><span class="pre">B</span></code> has two inputs <em>subject</em> and <em>in_file</em> and one output <em>out_file</em>, interface <code class="docutils literal notranslate"><span class="pre">C</span></code> has one input <em>in_file</em> and one output <em>out_file</em>, and interface <code class="docutils literal notranslate"><span class="pre">D</span></code> has one list input <em>in_files</em>. The <em>images</em> variable is a list of three input image file names.</p>
<p>As with <em>iterables</em> and the <code class="docutils literal notranslate"><span class="pre">MapNode</span></code> <em>iterfield</em>, the <em>joinfield</em> can be a list of fields. Thus, the declaration in the previous example is equivalent to the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">JoinNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">D</span><span class="p">(),</span>
             <span class="n">joinsource</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
             <span class="n">joinfield</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;in_files&quot;</span><span class="p">],</span>
             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <em>joinfield</em> defaults to all of the JoinNode input fields, so the declaration is also equivalent to the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">JoinNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">D</span><span class="p">(),</span>
             <span class="n">joinsource</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, the node <code class="docutils literal notranslate"><span class="pre">C</span></code> <em>out_file</em> outputs are collected into the <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code> <code class="docutils literal notranslate"><span class="pre">D</span></code> <em>in_files</em> input list. The <em>in_files</em> order is the same as the upstream <code class="docutils literal notranslate"><span class="pre">B</span></code> node iterables order.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code> input can be filtered for unique values by specifying the <em>unique</em> flag, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">JoinNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">D</span><span class="p">(),</span>
             <span class="n">joinsource</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span>
             <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="synchronize">
<h2><code class="docutils literal notranslate"><span class="pre">synchronize</span></code><a class="headerlink" href="#synchronize" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Node</span></code> <code class="docutils literal notranslate"><span class="pre">iterables</span></code> parameter can be be a single field or a list of fields. If it is a list, then execution is performed over all permutations of the list items. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])]</span>
</pre></div>
</div>
<p>results in the execution graph:</p>
<img src="../static/images/synchronize_1.png"  width="325">
<p>where <code class="docutils literal notranslate"><span class="pre">B13</span></code> has inputs <em>m</em> = 1, <em>n</em> = 3, <code class="docutils literal notranslate"><span class="pre">B14</span></code> has inputs  <em>m</em> = 1, <em>n</em> = 4, etc.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">synchronize</span></code> parameter synchronizes the iterables lists, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])]</span>
<span class="n">b</span><span class="o">.</span><span class="n">synchronize</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>results in the execution graph:</p>
<img src="../static/images/synchronize_2.png" width="160">
<p>where the iterable inputs are selected in lock-step by index, i.e.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(*m*, *n*) = (1, 3) and (2, 4)
</pre></div>
</div>
<p>for <code class="docutils literal notranslate"><span class="pre">B13</span></code> and <code class="docutils literal notranslate"><span class="pre">B24</span></code>, resp.</p>
</div>
<div class="section" id="itersource">
<h2><code class="docutils literal notranslate"><span class="pre">itersource</span></code><a class="headerlink" href="#itersource" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">itersource</span></code> feature allows you to expand a downstream <code class="docutils literal notranslate"><span class="pre">iterable</span></code> based on a mapping of an upstream <code class="docutils literal notranslate"><span class="pre">iterable</span></code>. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">A</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">B</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">b</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">C</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">D</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">itersource</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]})]</span>
<span class="n">my_workflow</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_workflow&quot;</span><span class="p">)</span>
<span class="n">my_workflow</span><span class="o">.</span><span class="n">connect</span><span class="p">([(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span><span class="s1">&#39;in_file&#39;</span><span class="p">)]),</span>
                     <span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span><span class="s1">&#39;in_file&#39;</span><span class="p">)])</span>
                     <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,[(</span><span class="s1">&#39;out_file&#39;</span><span class="p">,</span><span class="s1">&#39;in_file&#39;</span><span class="p">)])</span>
                     <span class="p">])</span>
</pre></div>
</div>
<p>results in the execution graph:</p>
<img src="../static/images/itersource_1.png" width="350">
<p>In this example, all interfaces have input <code class="docutils literal notranslate"><span class="pre">in_file</span></code> and output <code class="docutils literal notranslate"><span class="pre">out_file</span></code>. In addition, interface <code class="docutils literal notranslate"><span class="pre">B</span></code> has input <em>m</em> and interface <code class="docutils literal notranslate"><span class="pre">D</span></code> has input <em>n</em>. A Python dictionary associates the <code class="docutils literal notranslate"><span class="pre">B</span></code> node input value with the downstream <code class="docutils literal notranslate"><span class="pre">D</span></code> node <em>n</em> iterable values.</p>
<p>This example can be extended with a summary <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">JoinNode</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="n">E</span><span class="p">(),</span> <span class="n">joinsource</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
             <span class="n">joinfield</span><span class="o">=</span><span class="s2">&quot;in_files&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;e&quot;</span><span class="p">)</span>
<span class="n">my_workflow</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;out_file&#39;</span><span class="p">,</span>
                    <span class="n">e</span><span class="p">,</span> <span class="s1">&#39;in_files&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>resulting in the graph:</p>
<img src="../static/images/itersource_2.png" width="350">
<p>The combination of <code class="docutils literal notranslate"><span class="pre">iterables</span></code>, <code class="docutils literal notranslate"><span class="pre">MapNode</span></code>, <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code>, <code class="docutils literal notranslate"><span class="pre">synchronize</span></code> and <code class="docutils literal notranslate"><span class="pre">itersource</span></code> enables the creation of arbitrarily complex workflow graphs. The astute workflow builder will recognize that this flexibility is both a blessing and a curse. These advanced features are handy additions to the Nipype toolkit when used judiciously.</p>
</div>
<div class="section" id="more-realistic-joinnode-example">
<h2>More realistic <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code> example<a class="headerlink" href="#more-realistic-joinnode-example" title="Permalink to this headline">¶</a></h2>
<p>Let’s consider another example where we have one node that iterates over 3 different numbers and generates random numbers. Another node joins those three different numbers (each coming from a separate branch of the workflow) into one list. To make the whole thing a bit more realistic, the second node will use the <code class="docutils literal notranslate"><span class="pre">Function</span></code> interface to do something with those numbers, before we spit them out again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nipype</span> <span class="kn">import</span> <span class="n">JoinNode</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="n">Workflow</span>
<span class="kn">from</span> <span class="nn">nipype.interfaces.utility</span> <span class="kn">import</span> <span class="n">Function</span><span class="p">,</span> <span class="n">IdentityInterface</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_data_from_id</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate a random number based on id&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="k">return</span> <span class="nb">id</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">merge_and_scale_data</span><span class="p">(</span><span class="n">data2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Scale the input list by 1000&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>


<span class="n">node1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
                      <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">],</span>
                      <span class="n">function</span><span class="o">=</span><span class="n">get_data_from_id</span><span class="p">),</span>
             <span class="n">name</span><span class="o">=</span><span class="s1">&#39;get_data&#39;</span><span class="p">)</span>
<span class="n">node1</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">node2</span> <span class="o">=</span> <span class="n">JoinNode</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data2&#39;</span><span class="p">],</span>
                          <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data_scaled&#39;</span><span class="p">],</span>
                          <span class="n">function</span><span class="o">=</span><span class="n">merge_and_scale_data</span><span class="p">),</span>
                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;scale_data&#39;</span><span class="p">,</span>
                 <span class="n">joinsource</span><span class="o">=</span><span class="n">node1</span><span class="p">,</span>
                 <span class="n">joinfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data2&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wf</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;testjoin&#39;</span><span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="s1">&#39;data1&#39;</span><span class="p">,</span> <span class="n">node2</span><span class="p">,</span> <span class="s1">&#39;data2&#39;</span><span class="p">)</span>
<span class="n">eg</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>211017-17:58:34,755 nipype.workflow INFO:
	 Workflow testjoin settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
211017-17:58:34,793 nipype.workflow INFO:
	 Running serially.
211017-17:58:34,796 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.get_data&quot; in &quot;/tmp/tmpd947muth/testjoin/_id_3/get_data&quot;.
211017-17:58:34,801 nipype.workflow INFO:
	 [Node] Running &quot;get_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:34,820 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.get_data&quot;.
211017-17:58:34,821 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.get_data&quot; in &quot;/tmp/tmpa65pphaq/testjoin/_id_2/get_data&quot;.
211017-17:58:34,826 nipype.workflow INFO:
	 [Node] Running &quot;get_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:34,833 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.get_data&quot;.
211017-17:58:34,834 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.get_data&quot; in &quot;/tmp/tmpyp62y5dz/testjoin/_id_1/get_data&quot;.
211017-17:58:34,842 nipype.workflow INFO:
	 [Node] Running &quot;get_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:34,851 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.get_data&quot;.
211017-17:58:34,853 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.scale_data&quot; in &quot;/tmp/tmp7hdciny5/testjoin/scale_data&quot;.
211017-17:58:34,867 nipype.workflow INFO:
	 [Node] Running &quot;scale_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:34,880 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.scale_data&quot;.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wf</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;graph_detailed.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>211017-17:58:35,132 nipype.workflow INFO:
	 Generated workflow graph: /home/neuro/workshop_weizmann/workshop/nipype/notebooks/graph.png (graph2use=exec, simple_form=True).
</pre></div>
</div>
<img alt="../../_images/basic_joinnodes_23_1.png" src="../../_images/basic_joinnodes_23_1.png" />
</div>
</div>
<p>Now, let’s look at the input and output of the joinnode:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">eg</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;scale_data&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">result</span>
<span class="n">res</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data_scaled = [1217.0315662669173, 2744.9636514899635, 3046.9774571686444]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">inputs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;function_str&#39;: &#39;def merge_and_scale_data(data2):\n    &quot;&quot;&quot;Scale the input list by 1000&quot;&quot;&quot;\n    import numpy as np\n    return (np.array(data2) * 1000).tolist()\n&#39;,
 &#39;data2&#39;: [1.2170315662669173, 2.7449636514899636, 3.0469774571686443]}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extending-to-multiple-nodes">
<h2>Extending to multiple nodes<a class="headerlink" href="#extending-to-multiple-nodes" title="Permalink to this headline">¶</a></h2>
<p>We extend the workflow by using three nodes. Note that even this workflow, the joinsource corresponds to the node containing iterables and the joinfield corresponds to the input port of the JoinNode that aggregates the iterable branches. As before the graph below shows how the execution process is set up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_data_from_id</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="k">return</span> <span class="nb">id</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">scale_data</span><span class="p">(</span><span class="n">data2</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="k">return</span> <span class="n">data2</span>

<span class="k">def</span> <span class="nf">replicate</span><span class="p">(</span><span class="n">data3</span><span class="p">,</span> <span class="n">nreps</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">data3</span> <span class="o">*</span> <span class="n">nreps</span>

<span class="n">node1</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span>
                      <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">],</span>
                      <span class="n">function</span><span class="o">=</span><span class="n">get_data_from_id</span><span class="p">),</span>
             <span class="n">name</span><span class="o">=</span><span class="s1">&#39;get_data&#39;</span><span class="p">)</span>
<span class="n">node1</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">node2</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data2&#39;</span><span class="p">],</span>
                      <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data_scaled&#39;</span><span class="p">],</span>
                      <span class="n">function</span><span class="o">=</span><span class="n">scale_data</span><span class="p">),</span>
             <span class="n">name</span><span class="o">=</span><span class="s1">&#39;scale_data&#39;</span><span class="p">)</span>

<span class="n">node3</span> <span class="o">=</span> <span class="n">JoinNode</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data3&#39;</span><span class="p">],</span>
                          <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data_repeated&#39;</span><span class="p">],</span>
                          <span class="n">function</span><span class="o">=</span><span class="n">replicate</span><span class="p">),</span>
                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;replicate_data&#39;</span><span class="p">,</span>
                 <span class="n">joinsource</span><span class="o">=</span><span class="n">node1</span><span class="p">,</span>
                 <span class="n">joinfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wf</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;testjoin&#39;</span><span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">node1</span><span class="p">,</span> <span class="s1">&#39;data1&#39;</span><span class="p">,</span> <span class="n">node2</span><span class="p">,</span> <span class="s1">&#39;data2&#39;</span><span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">node2</span><span class="p">,</span> <span class="s1">&#39;data_scaled&#39;</span><span class="p">,</span> <span class="n">node3</span><span class="p">,</span> <span class="s1">&#39;data3&#39;</span><span class="p">)</span>
<span class="n">eg</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>211017-17:58:35,220 nipype.workflow INFO:
	 Workflow testjoin settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
211017-17:58:35,283 nipype.workflow INFO:
	 Running serially.
211017-17:58:35,285 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.get_data&quot; in &quot;/tmp/tmpwedf30h4/testjoin/_id_3/get_data&quot;.
211017-17:58:35,295 nipype.workflow INFO:
	 [Node] Running &quot;get_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:35,303 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.get_data&quot;.
211017-17:58:35,305 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.scale_data&quot; in &quot;/tmp/tmpbs5eiex1/testjoin/_id_3/scale_data&quot;.
211017-17:58:35,312 nipype.workflow INFO:
	 [Node] Running &quot;scale_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:35,323 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.scale_data&quot;.
211017-17:58:35,326 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.get_data&quot; in &quot;/tmp/tmp5lx_f4ju/testjoin/_id_2/get_data&quot;.
211017-17:58:35,331 nipype.workflow INFO:
	 [Node] Running &quot;get_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:35,340 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.get_data&quot;.
211017-17:58:35,343 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.scale_data&quot; in &quot;/tmp/tmpv_w1w7p9/testjoin/_id_2/scale_data&quot;.
211017-17:58:35,351 nipype.workflow INFO:
	 [Node] Running &quot;scale_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:35,367 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.scale_data&quot;.
211017-17:58:35,369 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.get_data&quot; in &quot;/tmp/tmpduqhlg6r/testjoin/_id_1/get_data&quot;.
211017-17:58:35,376 nipype.workflow INFO:
	 [Node] Running &quot;get_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:35,386 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.get_data&quot;.
211017-17:58:35,388 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.scale_data&quot; in &quot;/tmp/tmp31ftmvro/testjoin/_id_1/scale_data&quot;.
211017-17:58:35,401 nipype.workflow INFO:
	 [Node] Running &quot;scale_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:35,409 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.scale_data&quot;.
211017-17:58:35,410 nipype.workflow INFO:
	 [Node] Setting-up &quot;testjoin.replicate_data&quot; in &quot;/tmp/tmpwdt8u7hr/testjoin/replicate_data&quot;.
211017-17:58:35,426 nipype.workflow INFO:
	 [Node] Running &quot;replicate_data&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:35,438 nipype.workflow INFO:
	 [Node] Finished &quot;testjoin.replicate_data&quot;.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wf</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;graph_detailed.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>211017-17:58:35,704 nipype.workflow INFO:
	 Generated workflow graph: /home/neuro/workshop_weizmann/workshop/nipype/notebooks/graph.png (graph2use=exec, simple_form=True).
</pre></div>
</div>
<img alt="../../_images/basic_joinnodes_30_1.png" src="../../_images/basic_joinnodes_30_1.png" />
</div>
</div>
<div class="section" id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<p>You have list of DOB of the subjects in a few various format : <code class="docutils literal notranslate"><span class="pre">[&quot;10</span> <span class="pre">February</span> <span class="pre">1984&quot;,</span> <span class="pre">&quot;March</span> <span class="pre">5</span> <span class="pre">1990&quot;,</span> <span class="pre">&quot;April</span> <span class="pre">2</span> <span class="pre">1782&quot;,</span> <span class="pre">&quot;June</span> <span class="pre">6,</span> <span class="pre">1988&quot;,</span> <span class="pre">&quot;12</span> <span class="pre">May</span> <span class="pre">1992&quot;]</span></code>, and you want to sort the list.</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">Node</span></code> with <code class="docutils literal notranslate"><span class="pre">iterables</span></code> to extract day, month and year, and use <a class="reference external" href="https://docs.python.org/2/library/datetime.html">datetime.datetime</a> to unify the format that can be compared, and <code class="docutils literal notranslate"><span class="pre">JoinNode</span></code> to sort the list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write your solution here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the list of all DOB</span>
<span class="n">dob_subjects</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;10 February 1984&quot;</span><span class="p">,</span> <span class="s2">&quot;March 5 1990&quot;</span><span class="p">,</span> <span class="s2">&quot;April 2 1782&quot;</span><span class="p">,</span> <span class="s2">&quot;June 6, 1988&quot;</span><span class="p">,</span> <span class="s2">&quot;12 May 1992&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s start from creating Node with iterable to split all strings from the list</span>
<span class="kn">from</span> <span class="nn">nipype</span> <span class="kn">import</span> <span class="n">Node</span><span class="p">,</span> <span class="n">JoinNode</span><span class="p">,</span> <span class="n">Function</span><span class="p">,</span> <span class="n">Workflow</span>

<span class="k">def</span> <span class="nf">split_dob</span><span class="p">(</span><span class="n">dob_string</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">dob_string</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="n">split_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dob_string&quot;</span><span class="p">],</span> 
                              <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;split_list&quot;</span><span class="p">],</span> 
                              <span class="n">function</span><span class="o">=</span><span class="n">split_dob</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;splitting&quot;</span><span class="p">)</span>

<span class="c1">#split_node.inputs.dob_string = &quot;10 February 1984&quot;</span>
<span class="n">split_node</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;dob_string&quot;</span><span class="p">,</span> <span class="n">dob_subjects</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and now let&#39;s work on the date format more, independently for every element</span>

<span class="c1"># sometimes the second element has an extra &quot;,&quot; that we should remove</span>
<span class="k">def</span> <span class="nf">remove_comma</span><span class="p">(</span><span class="n">str_list</span><span class="p">):</span>
    <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">str_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">str_list</span>

<span class="n">cleaning_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;str_list&quot;</span><span class="p">],</span> 
                              <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;str_list_clean&quot;</span><span class="p">],</span> 
                              <span class="n">function</span><span class="o">=</span><span class="n">remove_comma</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;cleaning&quot;</span><span class="p">)</span>


<span class="c1"># now we can extract year, month, day from our list and create ``datetime.datetim`` object</span>
<span class="k">def</span> <span class="nf">datetime_format</span><span class="p">(</span><span class="n">date_list</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">datetime</span>
    <span class="c1"># year is always the last</span>
    <span class="n">year</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">date_list</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="c1">#day and month can be in the first or second position</span>
    <span class="c1"># we can use datetime.datetime.strptime to convert name of the month to integer</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">date_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;%B&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span>
    <span class="k">except</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">date_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">month</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;%B&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span>
    <span class="c1"># and create datetime.datetime format</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span>


<span class="n">datetime_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date_list&quot;</span><span class="p">],</span> 
                                  <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;datetime&quot;</span><span class="p">],</span> 
                              <span class="n">function</span><span class="o">=</span><span class="n">datetime_format</span><span class="p">),</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;datetime&quot;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now we are ready to create JoinNode and sort the list of DOB</span>

<span class="k">def</span> <span class="nf">sorting_dob</span><span class="p">(</span><span class="n">datetime_list</span><span class="p">):</span>
    <span class="n">datetime_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">datetime_list</span>

<span class="n">sorting_node</span> <span class="o">=</span> <span class="n">JoinNode</span><span class="p">(</span><span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;datetime_list&quot;</span><span class="p">],</span> 
                              <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dob_sorted&quot;</span><span class="p">],</span> 
                              <span class="n">function</span><span class="o">=</span><span class="n">sorting_dob</span><span class="p">),</span>
                    <span class="n">joinsource</span><span class="o">=</span><span class="n">split_node</span><span class="p">,</span> <span class="c1"># this is the node that used iterables for x</span>
                    <span class="n">joinfield</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;datetime_list&#39;</span><span class="p">],</span>
                    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sorting&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and we&#39;re ready to create workflow</span>

<span class="n">ex1_wf</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sorting_dob&quot;</span><span class="p">)</span>
<span class="n">ex1_wf</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">split_node</span><span class="p">,</span> <span class="s2">&quot;split_list&quot;</span><span class="p">,</span> <span class="n">cleaning_node</span><span class="p">,</span> <span class="s2">&quot;str_list&quot;</span><span class="p">)</span>
<span class="n">ex1_wf</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">cleaning_node</span><span class="p">,</span> <span class="s2">&quot;str_list_clean&quot;</span><span class="p">,</span> <span class="n">datetime_node</span><span class="p">,</span> <span class="s2">&quot;date_list&quot;</span><span class="p">)</span>
<span class="n">ex1_wf</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">datetime_node</span><span class="p">,</span> <span class="s2">&quot;datetime&quot;</span><span class="p">,</span> <span class="n">sorting_node</span><span class="p">,</span> <span class="s2">&quot;datetime_list&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># you can check the graph</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">ex1_wf</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;exec&#39;</span><span class="p">)</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;graph_detailed.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>211017-17:58:36,124 nipype.workflow INFO:
	 Generated workflow graph: /home/neuro/workshop_weizmann/workshop/nipype/notebooks/graph.png (graph2use=exec, simple_form=True).
</pre></div>
</div>
<img alt="../../_images/basic_joinnodes_38_1.png" src="../../_images/basic_joinnodes_38_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and run the workflow</span>
<span class="n">ex1_res</span> <span class="o">=</span> <span class="n">ex1_wf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>211017-17:58:36,146 nipype.workflow INFO:
	 Workflow sorting_dob settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
211017-17:58:36,196 nipype.workflow INFO:
	 Running serially.
211017-17:58:36,198 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.splitting&quot; in &quot;/tmp/tmpa0k7vtmz/sorting_dob/_dob_string_12May1992/splitting&quot;.
211017-17:58:36,203 nipype.workflow INFO:
	 [Node] Running &quot;splitting&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,211 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.splitting&quot;.
211017-17:58:36,212 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.cleaning&quot; in &quot;/tmp/tmpgmwqmi56/sorting_dob/_dob_string_12May1992/cleaning&quot;.
211017-17:58:36,218 nipype.workflow INFO:
	 [Node] Running &quot;cleaning&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,228 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.cleaning&quot;.
211017-17:58:36,230 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.datetime&quot; in &quot;/tmp/tmpqbe44hu6/sorting_dob/_dob_string_12May1992/datetime&quot;.
211017-17:58:36,236 nipype.workflow INFO:
	 [Node] Running &quot;datetime&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,244 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.datetime&quot;.
211017-17:58:36,245 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.splitting&quot; in &quot;/tmp/tmp9bwk1yxq/sorting_dob/_dob_string_June6.1988/splitting&quot;.
211017-17:58:36,250 nipype.workflow INFO:
	 [Node] Running &quot;splitting&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,259 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.splitting&quot;.
211017-17:58:36,260 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.cleaning&quot; in &quot;/tmp/tmpm04ievem/sorting_dob/_dob_string_June6.1988/cleaning&quot;.
211017-17:58:36,267 nipype.workflow INFO:
	 [Node] Running &quot;cleaning&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,274 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.cleaning&quot;.
211017-17:58:36,275 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.datetime&quot; in &quot;/tmp/tmpdn4yyo_p/sorting_dob/_dob_string_June6.1988/datetime&quot;.
211017-17:58:36,281 nipype.workflow INFO:
	 [Node] Running &quot;datetime&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,287 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.datetime&quot;.
211017-17:58:36,288 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.splitting&quot; in &quot;/tmp/tmp_vulyv43/sorting_dob/_dob_string_April21782/splitting&quot;.
211017-17:58:36,293 nipype.workflow INFO:
	 [Node] Running &quot;splitting&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,303 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.splitting&quot;.
211017-17:58:36,304 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.cleaning&quot; in &quot;/tmp/tmp0fv63bai/sorting_dob/_dob_string_April21782/cleaning&quot;.
211017-17:58:36,309 nipype.workflow INFO:
	 [Node] Running &quot;cleaning&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,317 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.cleaning&quot;.
211017-17:58:36,318 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.datetime&quot; in &quot;/tmp/tmptwol95f9/sorting_dob/_dob_string_April21782/datetime&quot;.
211017-17:58:36,325 nipype.workflow INFO:
	 [Node] Running &quot;datetime&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,333 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.datetime&quot;.
211017-17:58:36,334 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.splitting&quot; in &quot;/tmp/tmpn88cyhvn/sorting_dob/_dob_string_March51990/splitting&quot;.
211017-17:58:36,340 nipype.workflow INFO:
	 [Node] Running &quot;splitting&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,348 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.splitting&quot;.
211017-17:58:36,350 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.cleaning&quot; in &quot;/tmp/tmpa9bspp1x/sorting_dob/_dob_string_March51990/cleaning&quot;.
211017-17:58:36,355 nipype.workflow INFO:
	 [Node] Running &quot;cleaning&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,366 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.cleaning&quot;.
211017-17:58:36,367 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.datetime&quot; in &quot;/tmp/tmpvt72jqs4/sorting_dob/_dob_string_March51990/datetime&quot;.
211017-17:58:36,378 nipype.workflow INFO:
	 [Node] Running &quot;datetime&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,383 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.datetime&quot;.
211017-17:58:36,384 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.splitting&quot; in &quot;/tmp/tmpa6t1_e00/sorting_dob/_dob_string_10February1984/splitting&quot;.
211017-17:58:36,391 nipype.workflow INFO:
	 [Node] Running &quot;splitting&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,399 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.splitting&quot;.
211017-17:58:36,401 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.cleaning&quot; in &quot;/tmp/tmp23sedoyp/sorting_dob/_dob_string_10February1984/cleaning&quot;.
211017-17:58:36,407 nipype.workflow INFO:
	 [Node] Running &quot;cleaning&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,415 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.cleaning&quot;.
211017-17:58:36,417 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.datetime&quot; in &quot;/tmp/tmpl6ko9goa/sorting_dob/_dob_string_10February1984/datetime&quot;.
211017-17:58:36,422 nipype.workflow INFO:
	 [Node] Running &quot;datetime&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,430 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.datetime&quot;.
211017-17:58:36,431 nipype.workflow INFO:
	 [Node] Setting-up &quot;sorting_dob.sorting&quot; in &quot;/tmp/tmp4xnniix3/sorting_dob/sorting&quot;.
211017-17:58:36,442 nipype.workflow INFO:
	 [Node] Running &quot;sorting&quot; (&quot;nipype.interfaces.utility.wrappers.Function&quot;)
211017-17:58:36,447 nipype.workflow INFO:
	 [Node] Finished &quot;sorting_dob.sorting&quot;.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># you can check list of all nodes</span>
<span class="n">ex1_res</span><span class="o">.</span><span class="n">nodes</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NodeView((sorting_dob.sorting, sorting_dob.splitting.aI.a0, sorting_dob.cleaning.a0, sorting_dob.datetime.a0, sorting_dob.splitting.aI.a1, sorting_dob.cleaning.a1, sorting_dob.datetime.a1, sorting_dob.splitting.aI.a2, sorting_dob.cleaning.a2, sorting_dob.datetime.a2, sorting_dob.splitting.aI.a3, sorting_dob.cleaning.a3, sorting_dob.datetime.a3, sorting_dob.splitting.aI.a4, sorting_dob.cleaning.a4, sorting_dob.datetime.a4))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># and check the results from sorting_dob.sorting</span>
<span class="nb">list</span><span class="p">(</span><span class="n">ex1_res</span><span class="o">.</span><span class="n">nodes</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dob_sorted = [datetime.datetime(1782, 4, 2, 0, 0), datetime.datetime(1984, 2, 10, 0, 0), datetime.datetime(1988, 6, 6, 0, 0), datetime.datetime(1990, 3, 5, 0, 0), datetime.datetime(1992, 5, 12, 0, 0)]
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nipype/notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="basic_mapnodes.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">MapNode</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="basic_debug.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Debugging Nipype Workflows</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Peer Herholz<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>