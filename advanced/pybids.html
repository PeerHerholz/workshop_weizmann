
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introduction to pybids &#8212; MRI analysis in Python using Nipype, Nilearn and more</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Nilearn GLM: statistical analyses of MRI in Python" href="statistical_analyses_MRI.html" />
    <link rel="prev" title="Advanced and specialized analyses" href="../advanced.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/nipy_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MRI analysis in Python using Nipype, Nilearn and more</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome!
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Workshop overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../setup.html">
   Setup for the workshop
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../outline.html">
   Outline
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../prerequisites.html">
   Course prerequisites
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/intro_to_shell.html">
     Introduction to the (unix) command line: bash
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/intro_to_git_and_github.html">
     Introduction to git and github
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/intro_jupyter.html">
     Introduction to the jupyter ecosystem &amp; notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/intro_python.html">
     Introduction to Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/python_numpy.html">
     Introduction to NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/python_scipy.html">
     Introduction to SciPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/python_visualization.html">
     Introduction to Visualization in python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/intro_statistics.html">
     Introduction to Statistics in python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../prerequisites/python_scikit.html">
     Introduction to scikit-learn &amp; scikit-image
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../data/data.html">
   Basics in data handling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../data/image_manipulation_nibabel.html">
     Using Python for neuroimaging data - NiBabel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../data/image_manipulation_nilearn.html">
     Using Python for neuroimaging data - Nilearn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../nipype/nipype_overview.html">
   Nipype
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype/nipype_intro.html">
     Introduction to Nipype
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/introduction_showcase.html">
       Nipype Showcase
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/introduction_quickstart.html">
       Nipype Quickstart
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/introduction_quickstart_non-neuroimaging.html">
       Nipype Quickstart - non-imaging
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/introduction_dataset.html">
       Tutorial Dataset
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype/nipype_basics.html">
     Basic concepts
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_interfaces.html">
       Interfaces
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_nodes.html">
       Nodes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_workflow.html">
       Workflows
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_graph_visualization.html">
       Graph Visualization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_data_input.html">
       Data Input
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_data_input_bids.html">
       Data input for BIDS datasets
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_data_output.html">
       Data Output
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_plugins.html">
       Using Nipype Plugins
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_function_interface.html">
       Function Interface
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_iteration.html">
       Iterables
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_mapnodes.html">
       MapNode
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_joinnodes.html">
       JoinNode, synchronize and itersource
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_debug.html">
       Debugging Nipype Workflows
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/basic_execution_configuration.html">
       Execution Configuration Options
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype/nipype_examples.html">
     Example workflows
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/example_preprocessing.html">
       Example 1: Preprocessing Workflow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/example_1stlevel.html">
       Example 2: 1st-level Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/example_normalize.html">
       Example 3: Normalize data to MNI template
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/example_2ndlevel.html">
       Example 4: 2nd-level Analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/handson_preprocessing.html">
       Hands-on 1: How to create a fMRI preprocessing workflow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/handson_analysis.html">
       Hands-on 2: How to create a fMRI analysis workflow
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype/nipype_advanced.html">
     Advanced concepts
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/advanced_create_interfaces.html">
       Create interfaces
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/advanced_interfaces_caching.html">
       Interface caching
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/advanced_nipypecli.html">
       Nipype Command Line Interface
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/advanced_aws.html">
       Using Nipype with Amazon Web Services (AWS)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/advanced_sphinx_ext.html">
       Sphinx extensions
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/advanced_spmmcr.html">
       Using SPM with MATLAB Common Runtime (MCR)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/advanced_mipav.html">
       Using MIPAV, JIST, and CBS Tools
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../nipype/nipype_resources.html">
     Resources
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/resources_installation.html">
       Download and install
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../nipype/notebooks/resources_help.html">
       Where to find help
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../advanced.html">
   Advanced and specialized analyses
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Introduction to
     <code class="docutils literal notranslate">
      <span class="pre">
       pybids
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="statistical_analyses_MRI.html">
     Nilearn GLM: statistical analyses of MRI in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="functional_connectivity.html">
     Functional connectivity and resting state
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="machine_learning_preparation.html">
     Preparation Machine Learning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="machine_learning_nilearn.html">
     MVPA and Searchlight with
     <code class="docutils literal notranslate">
      <span class="pre">
       nilearn
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="machine_learning_keras.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       TensorFlow
      </span>
     </code>
     /
     <code class="docutils literal notranslate">
      <span class="pre">
       Keras
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Predicting_age_with_machine_learning.html">
     Machine learning to predict age from rs-fmri
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../break.html">
   Yoga and/or dance break
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CoC.html">
   Code of Conduct
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/advanced/pybids.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/PeerHerholz/workshop_weizmann"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/PeerHerholz/workshop_weizmann/issues/new?title=Issue%20on%20page%20%2Fadvanced/pybids.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/PeerHerholz/workshop_weizmann/edit/main/workshop/advanced/pybids.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/PeerHerholz/workshop_weizmann/main?urlpath=tree/workshop/advanced/pybids.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-bidslayout">
   The
   <code class="docutils literal notranslate">
    <span class="pre">
     BIDSLayout
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#querying-the-bidslayout">
     Querying the
     <code class="docutils literal notranslate">
      <span class="pre">
       BIDSLayout
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-files-by-entities">
     Filtering files by entities
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-by-metadata">
     Filtering by metadata
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-return-type-values">
     Other
     <code class="docutils literal notranslate">
      <span class="pre">
       return_type
      </span>
     </code>
     values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#other-get-options">
     Other
     <code class="docutils literal notranslate">
      <span class="pre">
       get()
      </span>
     </code>
     options
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-bidsfile">
   The
   <code class="docutils literal notranslate">
    <span class="pre">
     BIDSFile
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-utilities">
   Other utilities
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filename-parsing">
     Filename parsing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#path-construction">
     Path construction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exporting-a-bidslayout-to-a-pandas-dataframe">
     Exporting a
     <code class="docutils literal notranslate">
      <span class="pre">
       BIDSLayout
      </span>
     </code>
     to a pandas
     <code class="docutils literal notranslate">
      <span class="pre">
       Dataframe
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bidsvalidator">
   BIDSValidator
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#report-generation">
   Report generation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="introduction-to-pybids">
<h1>Introduction to <code class="docutils literal notranslate"><span class="pre">pybids</span></code><a class="headerlink" href="#introduction-to-pybids" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/bids-standard/pybids"><code class="docutils literal notranslate"><span class="pre">pybids</span></code></a> is a tool to query, summarize and manipulate data using the BIDS standard.
In this tutorial we will use a <code class="docutils literal notranslate"><span class="pre">pybids</span></code> test dataset to illustrate some of the functionality of <code class="docutils literal notranslate"><span class="pre">pybids.layout</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bids</span> <span class="kn">import</span> <span class="n">BIDSLayout</span>
<span class="kn">from</span> <span class="nn">bids.tests</span> <span class="kn">import</span> <span class="n">get_test_data_path</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-bidslayout">
<h2>The <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code><a class="headerlink" href="#the-bidslayout" title="Permalink to this headline">¶</a></h2>
<p>At the core of pybids is the <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code> object. A <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code> is a lightweight Python class that represents a BIDS project file tree and provides a variety of helpful methods for querying and manipulating BIDS files. While the <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code> initializer has a large number of arguments you can use to control the way files are indexed and accessed, you will most commonly initialize a <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code> by passing in the BIDS dataset root location as a single argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we&#39;re using an example BIDS dataset that&#39;s bundled with the pybids tests</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;/data/ds000114/&#39;</span>

<span class="c1"># Initialize the layout</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">BIDSLayout</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>

<span class="c1"># Print some basic information about the layout</span>
<span class="n">layout</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="querying-the-bidslayout">
<h3>Querying the <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code><a class="headerlink" href="#querying-the-bidslayout" title="Permalink to this headline">¶</a></h3>
<p>When we initialize a <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code>, all of the files and metadata found under the specified root folder are indexed. This can take a few seconds (or, for very large datasets, a minute or two). Once initialization is complete, we can start querying the <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code> in various ways. The workhorse method is <a class="reference external" href="https://bids-standard.github.io/pybids/generated/bids.grabbids.BIDSLayout.html#bids.grabbids.BIDSLayout.get"><code class="docutils literal notranslate"><span class="pre">.get()</span></code></a>. If we call <code class="docutils literal notranslate"><span class="pre">.get()</span></code> with no additional arguments, we get back a list of all the BIDS files in our dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_files</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">{}</span><span class="s2"> files in the layout.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_files</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The first 10 files are:&quot;</span><span class="p">)</span>
<span class="n">all_files</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The returned object is a Python list. By default, each element in the list is a <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code> object. We discuss the <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code> object in much more detail below. For now, let’s simplify things and work with just filenames:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;filename&#39;</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout</span><span class="o">.</span><span class="n">get_subjects</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout</span><span class="o">.</span><span class="n">get_tasks</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout</span><span class="o">.</span><span class="n">get_entities</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This time, we get back only the names of the files.</p>
</div>
<div class="section" id="filtering-files-by-entities">
<h3>Filtering files by entities<a class="headerlink" href="#filtering-files-by-entities" title="Permalink to this headline">¶</a></h3>
<p>The utility of the <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code> would be pretty limited if all we could do was retrieve a list of all files in the dataset. Fortunately, the <code class="docutils literal notranslate"><span class="pre">.get()</span></code> method accepts all kinds of arguments that allow us to filter the result set based on specified criteria. In fact, we can pass <em>any</em> BIDS-defined keywords (or, as they’re called in PyBIDS, <em>entities</em>) as constraints. For example, here’s how we would retrieve all BOLD runs with <code class="docutils literal notranslate"><span class="pre">.nii.gz</span></code> extensions for subject ‘01’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve filenames of all BOLD runs for subject 01</span>
<span class="n">layout</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="s1">&#39;01&#39;</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s1">&#39;nii.gz&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;filename&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="s1">&#39;02&#39;</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="n">task</span><span class="o">=</span><span class="s2">&quot;linebisection&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you’re wondering what entities you can pass in as filtering arguments, the answer is contained in the .json configuration files <a class="reference external" href="https://github.com/bids-standard/pybids/tree/master/bids/layout/config">housed here</a>. To save you the trouble, here are a few of the most common entities:</p>
<ul class="simple">
<li><p>suffix: The part of a BIDS filename just before the extension (e.g., ‘bold’, ‘events’, ‘physio’, etc.).</p></li>
<li><p>subject: The subject label</p></li>
<li><p>session: The session label</p></li>
<li><p>run: The run index</p></li>
<li><p>task: The task name</p></li>
</ul>
<p>New entities are continually being defined as the spec grows, and in principle (though not always in practice), PyBIDS should be aware of all entities that are defined in the BIDS specification.</p>
</div>
<div class="section" id="filtering-by-metadata">
<h3>Filtering by metadata<a class="headerlink" href="#filtering-by-metadata" title="Permalink to this headline">¶</a></h3>
<p>All of the entities listed above are found in the names of BIDS files. But sometimes we want to search for files based not just on their names, but also based on metadata defined (per the BIDS spec) in JSON files. Fortunately for us, when we initialize a <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code>, all metadata files associated with BIDS files are automatically indexed. This means we can pass any key that occurs in any JSON file in our project as an argument to <code class="docutils literal notranslate"><span class="pre">.get()</span></code>. We can combine these with any number of core BIDS entities (like <code class="docutils literal notranslate"><span class="pre">subject</span></code>, <code class="docutils literal notranslate"><span class="pre">run</span></code>, etc.).</p>
<p>For example, say we want to retrieve all files where (a) the value of <code class="docutils literal notranslate"><span class="pre">SamplingFrequency</span></code> (a metadata key) is <code class="docutils literal notranslate"><span class="pre">100</span></code>, (b) the <code class="docutils literal notranslate"><span class="pre">acquisition</span></code> type is <code class="docutils literal notranslate"><span class="pre">'prefrontal'</span></code>, and (c) the subject is <code class="docutils literal notranslate"><span class="pre">'01'</span></code> or <code class="docutils literal notranslate"><span class="pre">'02'</span></code>. Here’s how we can do that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Retrieve all files where SamplingFrequency (a metadata key) = 100</span>
<span class="c1"># and acquisition = prefrontal, for the first two subjects</span>
<span class="n">layout</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;01&#39;</span><span class="p">,</span> <span class="s1">&#39;02&#39;</span><span class="p">],</span> <span class="n">SamplingFreequency</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">acq</span><span class="o">=</span><span class="s1">&#39;prefrontal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that we passed a list in for <code class="docutils literal notranslate"><span class="pre">subject</span></code> rather than just a string. This principle applies to all filters: you can always pass in a list instead of a single value, and this will be interpreted as a logical disjunction (i.e., a file must match any one of the provided values).</p>
</div>
<div class="section" id="other-return-type-values">
<h3>Other <code class="docutils literal notranslate"><span class="pre">return_type</span></code> values<a class="headerlink" href="#other-return-type-values" title="Permalink to this headline">¶</a></h3>
<p>While we’ll typically want to work with either <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code> objects or filenames, we can also ask <code class="docutils literal notranslate"><span class="pre">get()</span></code> to return unique values (or ids) of particular entities. For example, say we want to know which subjects have at least one <code class="docutils literal notranslate"><span class="pre">T1w</span></code> file. We can request that information by setting <code class="docutils literal notranslate"><span class="pre">return_type='id'</span></code>. When using this option, we also need to specify a target entity (or metadata keyword) called <code class="docutils literal notranslate"><span class="pre">target</span></code>. This combination tells the <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code> to return the unique values for the specified <code class="docutils literal notranslate"><span class="pre">target</span></code> entity. For example, in the next example, we ask for all of the unique subject IDs that have at least one file with a <code class="docutils literal notranslate"><span class="pre">T1w</span></code> suffix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ask get() to return the ids of subjects that have T1w files</span>
<span class="n">layout</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;T1w&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If our <code class="docutils literal notranslate"><span class="pre">target</span></code> is a BIDS entity that corresponds to a particular directory in the BIDS spec (e.g., <code class="docutils literal notranslate"><span class="pre">subject</span></code> or <code class="docutils literal notranslate"><span class="pre">session</span></code>) we can also use <code class="docutils literal notranslate"><span class="pre">return_type='dir'</span></code> to get all matching subdirectories:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;dir&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="other-get-options">
<h3>Other <code class="docutils literal notranslate"><span class="pre">get()</span></code> options<a class="headerlink" href="#other-get-options" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.get()</span></code> method has a number of other useful arguments that control its behavior. We won’t discuss these in detail here, but briefly, here are a couple worth knowing about:</p>
<ul class="simple">
<li><p>regex_search: If you set this to <code class="docutils literal notranslate"><span class="pre">True</span></code>, string filter argument values will be interpreted as regular expressions.</p></li>
<li><p>scope: If your BIDS dataset contains BIDS-derivatives sub-datasets, you can specify where you wa</p></li>
</ul>
</div>
</div>
<div class="section" id="the-bidsfile">
<h2>The <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code><a class="headerlink" href="#the-bidsfile" title="Permalink to this headline">¶</a></h2>
<p>When you call <code class="docutils literal notranslate"><span class="pre">.get()</span></code> on a <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code>, the default returned values are objects of class <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code>. A <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code> is a lightweight container for individual files in a BIDS dataset. It provides easy access to a variety of useful attributes and methods. Let’s take a closer look. First, let’s pick a random file from our existing <code class="docutils literal notranslate"><span class="pre">layout</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick the 15th file in the dataset</span>
<span class="n">bf</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="mi">15</span><span class="p">]</span>

<span class="c1"># Print it</span>
<span class="n">bf</span>
</pre></div>
</div>
</div>
</div>
<p>Here are some of the attributes and methods available to us in a <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code> (note that some of these are only available for certain subclasses of <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code>; e.g., you can’t call <code class="docutils literal notranslate"><span class="pre">get_image()</span></code> on a <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code> that doesn’t correspond to an image file!):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.path</span></code>: The full path of the associated file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.filename</span></code>: The associated file’s filename (without directory)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.dirname</span></code>: The directory containing the file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.get_entities()</span></code>: Returns information about entities associated with this <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code> (optionally including metadata)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.get_image()</span></code>: Returns the file contents as a nibabel image (only works for image files)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.get_df()</span></code>: Get file contents as a pandas DataFrame (only works for TSV files)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.get_metadata()</span></code>: Returns a dictionary of all metadata found in associated JSON files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.get_associations()</span></code>: Returns a list of all files associated with this one in some way</p></li>
</ul>
<p>Let’s see some of these in action.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print all the entities associated with this file, and their values</span>
<span class="n">bf</span><span class="o">.</span><span class="n">get_entities</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print all the metadata associated with this file</span>
<span class="n">bf</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can the union of both of the above in one shot like this</span>
<span class="n">bf</span><span class="o">.</span><span class="n">get_entities</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here are all the files associated with our target file in some way. Notice how we get back both the JSON sidecar for our target file, and the BOLD run that our target file contains physiological recordings for.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bf</span><span class="o">.</span><span class="n">get_associations</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>In cases where a file has a <code class="docutils literal notranslate"><span class="pre">.tsv.gz</span></code> or <code class="docutils literal notranslate"><span class="pre">.tsv</span></code> extension, it will automatically be created as a <code class="docutils literal notranslate"><span class="pre">BIDSDataFile</span></code>, and we can easily grab the contents as a pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use a different test dataset--one that contains physio recording files</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_test_data_path</span><span class="p">(),</span> <span class="s1">&#39;synthetic&#39;</span><span class="p">)</span>
<span class="n">layout2</span> <span class="o">=</span> <span class="n">BIDSLayout</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>

<span class="c1"># Get the first physiological recording file</span>
<span class="n">recfile</span> <span class="o">=</span> <span class="n">layout2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;physio&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Get contents as a DataFrame and show the first few rows</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">recfile</span><span class="o">.</span><span class="n">get_df</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>While it would have been easy enough to read the contents of the file ourselves with pandas’ <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> method, notice that in the above example, <code class="docutils literal notranslate"><span class="pre">get_df()</span></code> saved us the trouble of having to read the physiological recording file’s metadata, pull out the column names and sampling rate, and add timing information.</p>
<p>Mind you, if we don’t <em>want</em> the timing information, we can ignore it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">recfile</span><span class="o">.</span><span class="n">get_df</span><span class="p">(</span><span class="n">include_timing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="other-utilities">
<h2>Other utilities<a class="headerlink" href="#other-utilities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="filename-parsing">
<h3>Filename parsing<a class="headerlink" href="#filename-parsing" title="Permalink to this headline">¶</a></h3>
<p>Say you have a filename, and you want to manually extract BIDS entities from it. The <code class="docutils literal notranslate"><span class="pre">parse_file_entities</span></code> method provides the facility:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;/a/fake/path/to/a/BIDS/file/sub-01_run-1_T2w.nii.gz&quot;</span>
<span class="n">layout</span><span class="o">.</span><span class="n">parse_file_entities</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="path-construction">
<h3>Path construction<a class="headerlink" href="#path-construction" title="Permalink to this headline">¶</a></h3>
<p>You may want to create valid BIDS filenames for files that are new or hypothetical that would sit within your BIDS project. This is useful when you know what entity values you need to write out to, but don’t want to deal with looking up the precise BIDS file-naming syntax. In the example below, imagine we’ve created a new file containing stimulus presentation information, and we want to save it to a <code class="docutils literal notranslate"><span class="pre">.tsv.gz</span></code> file, per the BIDS naming conventions. All we need to do is define a dictionary with the name components, and <code class="docutils literal notranslate"><span class="pre">build_path</span></code> takes care of the rest (including injecting sub-directories!):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">entities</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="s1">&#39;01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="s1">&#39;nback&#39;</span><span class="p">,</span>
    <span class="s1">&#39;suffix&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span>
<span class="p">}</span>

<span class="n">layout</span><span class="o">.</span><span class="n">build_path</span><span class="p">(</span><span class="n">entities</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">build_path</span></code> in more sophisticated ways—for example, by defining your own set of matching templates that cover cases not supported by BIDS out of the box. For example, suppose you want to create a template for naming a new z-stat file. You could do something like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="c1"># Define the pattern to build out of the components passed in the dictionary</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;sub-</span><span class="si">{subject}</span><span class="s2">[_ses-</span><span class="si">{session}</span><span class="s2">]_task-</span><span class="si">{task}</span><span class="s2">[_acq-</span><span class="si">{acquisition}</span><span class="s2">][_rec-</span><span class="si">{reconstruction}</span><span class="s2">][_run-</span><span class="si">{run}</span><span class="s2">][_echo-</span><span class="si">{echo}</span><span class="s2">]_{suffix&lt;z&gt;}.nii.gz&quot;</span><span class="p">,</span>

<span class="n">entities</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="s1">&#39;01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;run&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="s1">&#39;n-back&#39;</span><span class="p">,</span>
    <span class="s1">&#39;suffix&#39;</span><span class="p">:</span> <span class="s1">&#39;z&#39;</span>
<span class="p">}</span>

<span class="c1"># Notice we pass the new pattern as the second argument</span>
<span class="n">layout</span><span class="o">.</span><span class="n">build_path</span><span class="p">(</span><span class="n">entities</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exporting-a-bidslayout-to-a-pandas-dataframe">
<h3>Exporting a <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code> to a pandas <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code><a class="headerlink" href="#exporting-a-bidslayout-to-a-pandas-dataframe" title="Permalink to this headline">¶</a></h3>
<p>If you want a summary of all the files in your <code class="docutils literal notranslate"><span class="pre">BIDSLayout</span></code>, but don’t want to have to iterate <code class="docutils literal notranslate"><span class="pre">BIDSFile</span></code> objects and extract their entities, you can get a nice bird’s-eye view of your dataset using the <code class="docutils literal notranslate"><span class="pre">to_df()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the layout to a pandas dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can also include metadata in the result if we like (which may blow up our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> if we have a large dataset). Note that in this case, most of our cells will have missing values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layout</span><span class="o">.</span><span class="n">to_df</span><span class="p">(</span><span class="n">metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="bidsvalidator">
<h2>BIDSValidator<a class="headerlink" href="#bidsvalidator" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">pybids</span></code> implicitly imports a <code class="docutils literal notranslate"><span class="pre">BIDSValidator</span></code> class from the separate <a class="reference external" href="https://github.com/bids-standard/bids-validator"><code class="docutils literal notranslate"><span class="pre">bids-validator</span></code></a> package. You can use the <code class="docutils literal notranslate"><span class="pre">BIDSValidator</span></code> to determine whether a filepath is a valid BIDS filepath, as well as answering questions about what kind of data it represents. Note, however, that this implementation of the BIDS validator is <em>not</em> necessarily up-to-date with the JavaScript version available online. Moreover, the Python validator only tests individual files, and is currently unable to validate entire BIDS datasets. For that, you should use the <a class="reference external" href="https://bids-standard.github.io/bids-validator/">online BIDS validator</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bids</span> <span class="kn">import</span> <span class="n">BIDSValidator</span>

<span class="c1"># Note that when using the bids validator, the filepath MUST be relative to the top level bids directory</span>
<span class="n">validator</span> <span class="o">=</span> <span class="n">BIDSValidator</span><span class="p">()</span>
<span class="n">validator</span><span class="o">.</span><span class="n">is_bids</span><span class="p">(</span><span class="s1">&#39;/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Can decide if a filepath represents a file part of the specification</span>
<span class="n">validator</span><span class="o">.</span><span class="n">is_file</span><span class="p">(</span><span class="s1">&#39;/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Can check if file a dataset top</span>
<span class="n">validator</span><span class="o">.</span><span class="n">is_top_level</span><span class="p">(</span><span class="s1">&#39;/dataset_description.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># or subject (or session) level</span>
<span class="n">validator</span><span class="o">.</span><span class="n">is_subject_level</span><span class="p">(</span><span class="s1">&#39;/dataset_description.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">validator</span><span class="o">.</span><span class="n">is_session_level</span><span class="p">(</span><span class="s1">&#39;/sub-01/ses-test/anat/sub-01_ses-test_T1w.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Can decide if a filepath represents phenotypic data</span>
<span class="n">validator</span><span class="o">.</span><span class="n">is_phenotypic</span><span class="p">(</span><span class="s1">&#39;/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="report-generation">
<h2>Report generation<a class="headerlink" href="#report-generation" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">PyBIDS</span></code> also allows you to automatically create data acquisition reports based on the available <code class="docutils literal notranslate"><span class="pre">image</span></code> and <code class="docutils literal notranslate"><span class="pre">meta-data</span></code> information. Comparable to functionality in e.g. <a class="reference external" href="https://fmriprep.org/en/stable/citing.html?highlight=boilerplate">fMRIPrep</a> this enables a new level of standardization and subsequent advancements (transparency, FAIR-ness, meta-analyses, etc.). Let’s import the <code class="docutils literal notranslate"><span class="pre">BIDSReport</span></code> function from the <code class="docutils literal notranslate"><span class="pre">reports</span></code> submodule and initiate a <code class="docutils literal notranslate"><span class="pre">BIDS</span></code> dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bids.reports</span> <span class="kn">import</span> <span class="n">BIDSReport</span>
<span class="kn">from</span> <span class="nn">bids.tests</span> <span class="kn">import</span> <span class="n">get_test_data_path</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">BIDSLayout</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_test_data_path</span><span class="p">(),</span> <span class="s1">&#39;synthetic&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Great, now we only need to apply the <code class="docutils literal notranslate"><span class="pre">BIDSReport</span></code> function to our <code class="docutils literal notranslate"><span class="pre">layout</span></code> and generate our report. (We’ll get some warnings as the example data set is missing some parts).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">report</span> <span class="o">=</span> <span class="n">BIDSReport</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

<span class="n">counter</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>As we can see, one pattern was detected and we can evaluate the actual corresponding information, that is our <code class="docutils literal notranslate"><span class="pre">report</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">main_report</span> <span class="o">=</span> <span class="n">counter</span><span class="o">.</span><span class="n">most_common</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">main_report</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./advanced"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../advanced.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Advanced and specialized analyses</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="statistical_analyses_MRI.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Nilearn GLM: statistical analyses of MRI in Python</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Peer Herholz<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>